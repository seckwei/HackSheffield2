<html>
    <head>
        <title>Lazy Web Devs</title>
        <style>
            * {
                font-family: sans-serif;
            }
        </style>
        <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"   integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc="   crossorigin="anonymous"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script>
            'use strict';
            let protocol = 'https',
                host = window.location.host,
                url = `${protocol}://${host}`;

            console.log(url);
            let socket = io.connect(url);

            function createElement(data){
                let element = $(`<${data.element}>`);
                element.attr('id', (data.id));
                element.css({
                    'width': data.width,
                    'height': data.height,
                    'background-color': data.bg
                });
                return element;
            }

            socket.on('message', (data) => {
                console.log(data);

                switch(data.action){
                    case 'create': {
                        if(data.parent && data.children){
                            let parent = createElement(data.parent),
                                child;
                            $('body').append(parent);
                            //parent.text(data.parent.content || new Date().getTime());

                            for(let i = 0; i < data.children.amount; i++){
                                child = createElement(data.children.child);
                                parent.append(child);
                                child.text(data.children.child.content || new Date().getTime());
                            }
                        }
                        else {
                            let element = createElement(data);
                            $('body').append(element);     
                            element.text(data.content);
                        }
                        break;
                    }
                    case 'edit': {
                        let element = $(`#${data.id}`);
                        element.css({
                            'height': data.height || element.height(),
                            'width': data.width || element.width()
                        });
                        break;
                    }
                    case 'delete': {
                        $(`#${data.id}`).remove();
                        break;
                    }
                }
            });
        </script>
    </head>
    <body>
    </body>
</html>
